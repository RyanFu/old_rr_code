
<%@page import="java.util.Map"%>
<%@page import="java.util.HashMap"%>
<%@page import="net.sf.json.JSONArray"%>
<%@page import="net.sf.json.JSONObject"%>
<%@page import="net.sf.json.JSON"%>
<%@page import="com.renren.windows.util.model.WeatherInfo"%>
<%@page import="com.xiaonei.platform.core.cache.MemCacheFactory"%>
<%@page import="java.util.List"%>
<%@page import="com.xiaonei.platform.core.cache.MemCacheManager"%>
<%@page import="com.xiaonei.platform.core.cache.MemCacheKeys"%><%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%
Map<String,String> map = new HashMap<String,String>();
map.put("60001001","北京");
map.put("60019001","重庆");
map.put("60002001","上海");
map.put("60006001","天津");
map.put("60033001","澳门");
map.put("60032001","香港");
map.put("60007001","合肥");
map.put("60007006","蚌埠");
map.put("60007010","芜湖");
map.put("60007007","淮南");
map.put("60007009","马鞍山");
map.put("60007012","安庆");
map.put("60007002","宿州");
map.put("60007005","阜阳");
map.put("60007004","亳州");
map.put("60007013","黄山");
map.put("60007008","滁州");
map.put("60007003","淮北");
map.put("60007011","铜陵");
map.put("60007017","宣城");
map.put("60007014","六安");
map.put("60007015","巢湖");
map.put("60007016","池州");
map.put("60017001","福州");
map.put("60017006","厦门");
map.put("60017009","宁德");
map.put("60017003","莆田");
map.put("60017005","泉州");
map.put("60017007","漳州");
map.put("60017008","龙岩");
map.put("60017004","三明");
map.put("60017002","南平");
map.put("60014001","兰州");
map.put("60014011","定西");
map.put("60014010","平凉");
map.put("60014009","庆阳");
map.put("60014006","武威");
map.put("60014003","金昌");
map.put("60014008","张掖");
map.put("60014007","酒泉");
map.put("60014005","天水");
map.put("60014013","临夏");
map.put("60014004","白银");
map.put("60012001","广州");
map.put("60012003","韶关");
map.put("60012010","惠州");
map.put("60012005","梅州");
map.put("60012007","汕头");
map.put("60012012","深圳");
map.put("60012013","珠海");
map.put("60012016","佛山");
map.put("60012017","肇庆");
map.put("60012021","湛江");
map.put("60012015","江门");
map.put("60012004","河源");
map.put("60012002","清远");
map.put("60012018","云浮");
map.put("60012006","潮州");
map.put("60012011","东莞");
map.put("60012014","中山");
map.put("60012019","阳江");
map.put("60012008","揭阳");
map.put("60012020","茂名");
map.put("60012009","汕尾");
map.put("60025001","南宁");
map.put("60025010","崇左");
map.put("60025003","柳州");
map.put("60025013","来宾");
map.put("60025002","桂林");
map.put("60025004","梧州");
map.put("60025014","贺州");
map.put("60025005","贵港");
map.put("60025006","玉林");
map.put("60025011","百色");
map.put("60025007","钦州");
map.put("60025012","河池");
map.put("60025008","北海");
map.put("60025009","防城港");
map.put("60024001","贵阳");
map.put("60024003","遵义");
map.put("60024004","安顺");
map.put("60024006","铜仁");
map.put("60024005","毕节");
map.put("60024002","六盘水");
map.put("60024009","黔西");
map.put("60030001","海口");
map.put("60030002","三亚");
map.put("60021001","石家庄");
map.put("60021007","保定");
map.put("60021002","张家口");
map.put("60021005","唐山");
map.put("60021006","廊坊");
map.put("60021009","沧州");
map.put("60021008","衡水");
map.put("60021010","邢台");
map.put("60021011","邯郸");
map.put("60021004","秦皇岛");
map.put("60018001","郑州");
map.put("60018007","安阳");
map.put("60018005","新乡");
map.put("60018011","许昌");
map.put("60018013","平顶山");
map.put("60018015","信阳");
map.put("60018014","南阳");
map.put("60018009","开封");
map.put("60018003","洛阳");
map.put("60018010","商丘");
map.put("60018004","焦作");
map.put("60018006","鹤壁");
map.put("60018008","濮阳");
map.put("60018016","周口");
map.put("60018012","漯河");
map.put("60018017","驻马店");
map.put("60018002","三门峡");
map.put("60003001","哈尔滨");
map.put("60003003","齐齐哈尔");
map.put("60003011","牡丹江");
map.put("60003008","佳木斯");
map.put("60003012","绥化");
map.put("60003004","黑河");
map.put("60003013","大兴安岭");
map.put("60003007","伊春");
map.put("60003005","大庆");
map.put("60003002","七台河");
map.put("60003010","鸡西");
map.put("60003006","鹤岗");
map.put("60003009","双鸭山");
map.put("60011001","武汉");
map.put("60011003","襄樊");
map.put("60011007","鄂州");
map.put("60011005","孝感");
map.put("60011006","黄冈");
map.put("60011008","黄石");
map.put("60011009","咸宁");
map.put("60011010","荆州");
map.put("60011011","宜昌");
map.put("60011013","恩施");
map.put("60011002","十堰");
map.put("60011012","随州");
map.put("60011004","荆门");
map.put("60013001","长沙");
map.put("60013007","湘潭");
map.put("60013006","株洲");
map.put("60013008","衡阳");
map.put("60013009","郴州");
map.put("60013003","常德");
map.put("60013004","益阳");
map.put("60013013","娄底");
map.put("60013011","邵阳");
map.put("60013005","岳阳");
map.put("60013002","张家界");
map.put("60013012","怀化");
map.put("60013010","永州");
map.put("60004001","长春");
map.put("60004004","吉林");
map.put("60004005","四平");
map.put("60004007","通化");
map.put("60004002","白城");
map.put("60004006","辽源");
map.put("60004003","松原");
map.put("60004008","白山");
map.put("60008001","南京");
map.put("60008012","无锡");
map.put("60008010","镇江");
map.put("60008013","苏州");
map.put("60008009","南通");
map.put("60008007","扬州");
map.put("60008006","盐城");
map.put("60008002","徐州");
map.put("60008005","淮安");
map.put("60008003","连云港");
map.put("60008011","常州");
map.put("60008008","泰州");
map.put("60008004","宿迁");
map.put("60022001","南昌");
map.put("60022002","九江");
map.put("60022008","上饶");
map.put("60022009","抚州");
map.put("60022010","宜春");
map.put("60022011","吉安");
map.put("60022007","赣州");
map.put("60022003","景德镇");
map.put("60022006","萍乡");
map.put("60022005","新余");
map.put("60022004","鹰潭");
map.put("60005001","沈阳");
map.put("60005010","大连");
map.put("60005008","鞍山");
map.put("60005005","抚顺");
map.put("60005006","本溪");
map.put("60005009","丹东");
map.put("60005013","锦州");
map.put("60005011","营口");
map.put("60005003","阜新");
map.put("60005007","辽阳");
map.put("60005004","铁岭");
map.put("60005002","朝阳");
map.put("60005012","盘锦");
map.put("60005014","葫芦岛");
map.put("60026001","呼和浩特");
map.put("60026002","包头");
map.put("60026003","乌海");
map.put("60026005","通辽");
map.put("60026004","赤峰");
map.put("60026007","鄂尔多斯");
map.put("60026006","呼伦贝尔");
map.put("60027001","银川");
map.put("60027002","石嘴山");
map.put("60027003","吴忠");
map.put("60027004","固原");
map.put("60027005","中卫");
map.put("60028001","西宁");
map.put("60028002","海东");
map.put("60028005","黄南");
map.put("60028004","海南");
map.put("60028006","果洛");
map.put("60028007","玉树");
map.put("60028008","海西");
map.put("60028003","海北");
map.put("60016001","济南");
map.put("60016009","青岛");
map.put("60016005","淄博");
map.put("60016003","德州");
map.put("60016007","烟台");
map.put("60016006","潍坊");
map.put("60016013","济宁");
map.put("60016014","泰安");
map.put("60016011","临沂");
map.put("60016017","菏泽");
map.put("60016016","滨州");
map.put("60016004","东营");
map.put("60016008","威海");
map.put("60016012","枣庄");
map.put("60016010","日照");
map.put("60016015","莱芜");
map.put("60016002","聊城");
map.put("60023001","太原");
map.put("60023003","大同");
map.put("60023004","阳泉");
map.put("60023008","晋中");
map.put("60023005","长治");
map.put("60023006","晋城");
map.put("60023009","临汾");
map.put("60023011","运城");
map.put("60023002","朔州");
map.put("60023007","忻州");
map.put("60023010","吕梁");
map.put("60010001","西安");
map.put("60010005","咸阳");
map.put("60010002","延安");
map.put("60010008","榆林");
map.put("60010004","渭南");
map.put("60010010","商洛");
map.put("60010009","安康");
map.put("60010007","汉中");
map.put("60010006","宝鸡");
map.put("60010003","铜川");
map.put("60015001","成都");
map.put("60015013","攀枝花");
map.put("60015010","自贡");
map.put("60015003","绵阳");
map.put("60015005","南充");
map.put("60015015","达州");
map.put("60015007","遂宁");
map.put("60015006","广安");
map.put("60015014","巴中");
map.put("60015011","泸州");
map.put("60015012","宜宾");
map.put("60015008","内江");
map.put("60015016","资阳");
map.put("60015009","乐山");
map.put("60015017","眉山");
map.put("60015021","凉山");
map.put("60015018","雅安");
map.put("60015020","甘孜");
map.put("60015019","阿坝");
map.put("60015004","德阳");
map.put("60015002","广元");
map.put("60031001","拉萨");
map.put("60031006","日喀则");
map.put("60031005","山南");
map.put("60031004","林芝");
map.put("60031003","昌都");
map.put("60031002","那曲");
map.put("60031007","阿里");
map.put("60029001","乌鲁木齐");
map.put("60029002","克拉玛依");
map.put("60029010","昌吉");
map.put("60029006","吐鲁番");
map.put("60029004","阿克苏");
map.put("60029003","喀什");
map.put("60029013","塔城");
map.put("60029007","哈密");
map.put("60029005","和田");
map.put("60029014","阿勒泰");
map.put("60020001","昆明");
map.put("60020012","大理");
map.put("60020014","红河");
map.put("60020002","曲靖");
map.put("60020004","保山");
map.put("60020015","文山");
map.put("60020003","玉溪");
map.put("60020013","楚雄");
map.put("60020005","昭通");
map.put("60020008","临沧");
map.put("60020010","怒江");
map.put("60020006","丽江");
map.put("60020009","德宏");
map.put("60009001","杭州");
map.put("60009002","湖州");
map.put("60009003","嘉兴");
map.put("60009005","宁波");
map.put("60009006","绍兴");
map.put("60009009","台州");
map.put("60009010","温州");
map.put("60009011","丽水");
map.put("60009008","金华");
map.put("60009007","衢州");
map.put("60009004","舟山");
map.put("60034001","台湾");
%>
<%
System.out.println(" getWeatherController.jsp");
String WeatherKey = "Weather_";
MemCacheKeys pool = MemCacheKeys.pool_default;

MemCacheManager manager = MemCacheFactory.getInstance().getManagerByPoolName(pool);
String rigionId = request.getParameter("code");//"60001001";
List<WeatherInfo> list = (List<WeatherInfo>) manager.get(WeatherKey + rigionId);
if(list == null || list.size() == 0) {
	request.setAttribute("wja","[]");
}
else{
	JSONObject bigjson = new JSONObject();
	JSONArray ja = new JSONArray();
	for(WeatherInfo w : list){
		out.println(w.getDate()+":"+w.getDayWeather()+":"+w.getNightWeather());
		JSONObject json = new JSONObject();
		json.put("date",w.getDate());
		json.put("dayWeather",w.getDayWeather());
		json.put("dayWindDesc",w.getDayWindDesc());
		json.put("dayWindDirection",w.getDayWindDirection());
		json.put("dayTemperature",w.getDayTemperature());
		json.put("nightWeather",w.getNightWeather());
		json.put("nightWindDesc",w.getNightWindDesc());
		json.put("nightWindDirection",w.getNightWindDirection());
		json.put("nightTemperature",w.getNightTemperature());
		ja.add(json);
	}
	bigjson.put("city",map.get(rigionId));
	bigjson.put("data",ja);
	request.setAttribute("wja",bigjson);
}
                         
javax.servlet.RequestDispatcher dis = request.getRequestDispatcher("/jsps/fmwidget/views/getweather.jsp");
dis.forward(request,response);
%>
